---
title: "我们输了AIxCC。那现在呢？"
publishDate: 2025-08-21
summary: "两年时间，七百万美元奖金，最终我们败北了。"
cat: "AIxCC"
lang: zh
---

两年时间，七百万美元奖金，最终我们败北了。

很长一段时间我都在到处吹嘘："我们在参加一个竞赛。我们几乎动员了整个实验室的学生，还有来自其他大学的合作者。比赛持续整整两年，我们全力以赴。"

你们中的一些人表示怀疑，比如，_"你们还有博士研究要做，怎么能花两年时间参加比赛？"_

公平地说，对我们来说这_就是_研究。以前没有人在这个领域做过类似的工作，而研究就是要解决别人没有尝试过的问题。让我为不熟悉的人介绍一下这个比赛。

<Callout title="AIxCC" icon="🐞">
AIxCC，全称**AI网络安全挑战赛**，是由DARPA主办、后来ARPA-H也加入的比赛。规则说起来简单做起来难：组织者给你一个代码库，里面有他们秘密注入的安全漏洞。你的任务是构建一个能够找到这些漏洞、弄清楚如何触发它们，然后修复它们的系统。

关键是：**你不能亲自做任何事情。** 这是一个完全自动化的黑盒比赛。不允许人类检查项目或审查代码。你编写系统，提交它，从那时起，系统完全独立完成工作。你只能坐在那里看它运行，中间零干预。
</Callout>

所以我们的工作从_成为_安全专家转变为_构建_安全专家系统（也许有一天会取代我们的工作）。在比赛中，这个系统被称为网络安全推理系统（CRS）。工作量巨大，对吧？有趣。有挑战性。令人兴奋。如果我们真的成功了，它可能会改变安全社区对AI的看法。它甚至可能引发新的研究趋势，或者甚至是一个全新的领域。这是我们想参与的一个重要原因。

第二个原因，奖金也不少：一百万启动资金，两百万进入决赛，四百万给获胜者。总共七百万美元的奖金。

巨大的研究机会，加上对一大笔钱的希望。这就是我们两年征程的开始。

<Dialog>
公平地说，我们确实得到了第一个一百万作为启动奖励，然后作为决赛选手又得到了两百万。所以这篇文章并不全是悲观的。
</Dialog>

## 征程

我第一次听说这个比赛是在2023年冬天。当时我正在读博士二年级。第一年很艰难：充满自我怀疑，很多失败的实验。到那年夏天，我几乎确信我的研究已经走进了死胡同。

我尝试用强化学习来替代AFL中基于启发式的种子选择。那没有任何进展。事实证明种子选择在模糊测试中并不那么重要。所以我转向了：如果让强化学习来_运行_模糊测试器会怎样？令我惊讶的是，第一个原型在FuzzBench覆盖率上超过了AFL++。我很兴奋，快速包装了系统，在2024年1月提交到SBFT模糊测试比赛，并获得了第一名。

<GithubRepo repo="whexy/bandfuzz" />

我们的PI，Xinyu，非常激动。那时，实验室分为两组：一组专注于系统安全研究如内核pwn，另一组专注于AI安全如后门攻击。BandFuzz是第一个将AI知识带入安全工具的跨界项目。它证明了我们有能力承担DARPA比赛。

然后半决赛的规则到了。仅仅找到漏洞是不够的，我们必须生成POC，一个真正触发漏洞的程序输入。这改变了一切。突然模糊测试变成了比赛的核心，从那时起，我就负责它，一直到最后。

2024年2月28日，经过一个通宵，我们有了第一个原型。获取仓库。构建它。运行模糊测试。获得POC。输入到LLM。生成补丁。重新运行补丁。确认漏洞已修复。

<Callout title="时间轴" icon="⏰">
- 上午6点 — Xinyu走进实验室，发现我们还在调试。
- 上午7点 — 我开车送大家回家，倒头就睡，醒来发现有张停车票。
</Callout>

从那里开始，一切都升级了。原型有效，突然新的团队涌现：内核模糊测试、静态分析、定向模糊测试、Java、补丁、集成。

每个人都在忙碌。编写CodeQL。构建protobufs。破解内核工具。训练LLM种子生成器。粘合管道。设置数据库。忙碌的早晨。每日站会。成堆的外卖。

但我们规划得不好。截止日期前一个月，一半的组件仍未合并。所以我成了粘合剂——从芝加哥飞到盐湖城，和集成团队坐在一起，把系统拼起来。

漏洞堆积如山。版本从0.0.1跳到2.3.2。系统每20秒就崩溃。大喊。修复。最终稳定。测试。提交。庆祝。

然后——发生了**最幸运的**事情。提交截止日期被延迟了。GitHub的服务器在截止时间崩溃了，许多团队无法提交。组织者将截止日期延长到第二天上午9点。

早上6点，我的电话响了。一个队友发现了一个严重漏洞：一个SQL查询可能会阻止我们在第一次运行后生成新补丁。如果那是真的，我们整个系统在真正的评估中都会失败。

紧急电话。每个人都醒了。笔记本电脑打开，眼睛半睁，但手在键盘上飞舞。调试，测试，修补。时钟滴答作响。最终，在新截止日期的**几秒钟**前，我们推送了一个新的Docker镜像来修复它。

## DEF CON 32的半决赛

半决赛结果在2024年8月的拉斯维加斯DEF CON 32上宣布。那是我第一次去维加斯。

那时，自我们提交以来已经过去了整整一个月。我们必须等那么久才能看到结果。DARPA真的想让它戏剧化。他们甚至在DEF CON内建了一个小"城镇"，有假火车可以坐，震动摇摆，就像迪士尼乐园一样。整个比赛都有华丽的可视化直播。一个巨大的屏幕显示**成就**：每当一个团队第一个找到漏洞（通过提交正确的PoV）或成功补丁（正确的修复）时，就会弹出一个金色徽章。当我们第一天早上出现时，我们是唯一拥有金色徽章的团队。

DEF CON的其他部分也很有趣。我们甚至去了Sphere看电影。我们的团队一直在成就榜顶部，所以我没有太担心能否进入决赛。

<Dialog>
至少，这是我的感受。我们的一个队友非常紧张，他从SHELLPHISH那里抓了一件T恤，坐在大厅里假装是他们的成员之一。
</Dialog>

我们的团队名字是**42-b3yond-6ug**。好的一点是，我们是唯一一个名字以数字开头的团队，所以每当组织者按字母顺序宣布任何事情时，我们总是第一个。当宣布决赛选手的时候，我们甚至没时间感到紧张。

看到半决赛结果，我们感到信心满满。我们是唯一找到Linux内核漏洞的团队。我们在漏洞发现方面很强——多亏了模糊测试——我们获得了很多成就徽章。

## 一个小故事

我们进入决赛后不久，我也步入了博士第三年。在组织者发布决赛规则之前有一个短暂的停顿。在那个间隙期间，我花了两个月写了一篇关于使用大型语言模型进行模糊测试种子生成的论文——正是我在半决赛中构建和使用的工具。论文带着学术界的强烈拒绝回来了：_"LLM不是你的贡献。"_

更糟糕的是，我的BandFuzz论文被抢先发表了。我们太忙了，甚至没有注意到另一个组织在顶级会议上发表了一篇论文——使用和我们完全相同的方法。

<Dialog>
那一刻我意识到学术界还没有准备好迎接这个。仍然停留在启发式方法上，仍然在把关，仍然对即将到来的变化视而不见。
</Dialog>

学术界，甚至我们，都没有完全看到接下来会发生什么。在半决赛中，我们依赖于GPT-4o和Claude-3。但在短短一年内，局面爆发了：GPT-o1、Claude 3.5、GPT-o3、Claude-4、GPT-4.1、Claude-4.1、GPT-5。模型在竞赛中前进。突然，即使是最怀疑AI的研究者也别无选择，只能跟上，否则就有被抛在后面的风险。每个人都想成为其中的一部分。

没有比AIxCC更好的机会来继续"成为其中的一部分"：一个将大学、工业界、政府和媒体聚集在一起，都专注于AI和软件安全的舞台。所以我们继续前进。

## 征程，续集

2025年1月，我终于收到了决赛比赛的规则，它们与半决赛大不相同。

<Callout title="AIxCC决赛规则" icon="⚖️">
首先，决赛将持续整整十天。我们的系统不再只是解决挑战；它必须承受持续的压力，处理失败，并在没有人工干预的情况下从崩溃中恢复。

其次，我们的计算预算从之前的三台64核服务器跳到了价值8.5万美元的Azure积分。这完全改变了游戏：我们现在必须设计、扩展和管理我们自己的基础设施。

然后是LLM预算。它从微薄的100美元上限增加到惊人的5万美元。这不仅仅是更多的令牌；它为半决赛中无法想象的全新解决策略打开了大门。

格式本身也发生了变化。一切都必须在OSS-Fuzz兼容环境中运行，这意味着我们为半决赛精心构建的管道突然变得过时了。我们需要从头开始重建。

为了让事情变得更加紧张，组织者在决赛前增加了三轮无评分的彩排。第一轮定在4月1日，只给了我们几个短周来准备一切。
</Callout>

从半决赛的经验中，我们痛苦地学到了我们无法处理如此大的团队。那很混乱，一些组件半开发，从未合并，最终被放弃。所以对于决赛，我们将小组缩小到大约八名博士生（加上他们的导师）的核心团队。

但是人手更少，截止日期逼近，我对集成提出了担忧。在半决赛中，我们将集成塞进了最后一个月，那是一场灾难。我在盐湖城；我亲眼看到了混乱。这次，Xinyu让我负责集成。这意味着我现在有两个工作：领导模糊测试子系统（模糊测试本身加上一些支持代理），以及保持整个系统粘合在一起。

### 走向第一轮

承担集成意味着我不能只待在项目的一个角落里。我必须接触几乎所有东西。那时我的角色从仅仅是开发者转变为更接近*首席工程师*的角色。

事实是，我没有真正的架构师经验。所以最终，管道反映了我自己的偏见。我编写了基础设施自动化。我画了成为我们Kubernetes组件图的蓝图。我推动了几个关键的技术决策——消息驱动管道、泵送、存储。不是每个人都喜欢它们，但它们将系统保持在一起。

**这把我推到了一个奇怪的位置。** 我不是团队领导，所以我没有权威指挥任何人。但是因为我设计了系统，我仍然得到所有的抱怨——数据库模式不是他们想要的，泵送系统"太麻烦了"。基本上，我从双方都被骂，但实际上没有负责任何事情。我真正的挑战不是编码——而是弄清楚如何与人交谈，而不破坏合作，不看起来像个混蛋，不让每个人都暗地里讨厌我。

我还必须匆忙推出一些新组件来适应更新的比赛格式。那时我发现Go在这种工作中有多好：强类型，清晰定义，快速开发，以及简单的异步支持。所以是的，你会在我们的系统中找到很多Go代码。那也是我的偏见之一。

到2月底，我们第一次让系统端到端运行。我们也在模拟测试上投入了很多精力。到3月（第一轮前一个月），我们收集了100多个真实世界的有漏洞提交，可以转化为测试。

<Callout title="另一个小故事" icon="📖">
第一轮提交前一周，我强迫自己休息一下。长时间工作开始对身体造成影响。我去维加斯短途旅行，希望休息，但压力跟着我。它甚至影响了我与人的互动，紧张了我关心的关系。那时我意识到这个比赛不仅在燃烧LLM令牌；它也在燃烧我。
</Callout>

尽管如此，还有一线希望：第一次，我们有了一个真正的端到端运行系统。无论接下来会发生什么，我们知道我们构建了一些有效的东西，这给了我们希望。

### 接近第二轮

我们在第一轮中幸存下来。正如预期的那样，很多组件在运行期间崩溃了，但我们的系统足够坚韧来吸收打击。我们到处都有备份（例如，三个独立的模糊测试管道），所以没有什么破坏到无法修复。

我们的关键工具之一是程序切片器：一个映射路径到目标位置的静态分析工具，它对模糊测试帮助很大。但在第一轮中，它完全失败了。该工具依赖于旧的LLVM 14，而挑战是用新的C23语法编写的。

所以我们试图将它移植到LLVM 18。那证明是一个错误。我们在将我们的切片器移植到新编译器上下赌注，结果适得其反。然而，我们有四个人被困在上面，这意味着只有其他四个人留下来维护系统的其余部分。

与此同时，新的压力落在了我的肩上。在第一轮中，我们只在两天内花费了1万美元预算中的大约1000美元。然后组织者宣布第二轮将带来2万美元的预算。那时我意识到：是时候认真对待扩展了。

这里有一点幸运派上用场。早些时候，我推动团队采用消息驱动管道并将组件状态存储在KV缓存中。当时，这只是一个崩溃恢复策略，确保我们不会丢失进度。但它证明正是我们扩展所需要的。我们为每个组件制定了扩展计划：更多任务意味着更多模糊测试器，更多PoV意味着更多分类...它们都工作得很好。

我也花时间完全重写了BandFuzz。现在，在更大的规模上，它可以在集群中启动和管理近2000个模糊测试器。那时强化学习真的闪闪发光。

### 冲向第三轮

我们的程序切片器在第二轮中再次崩溃。我们仍然有三个人被困在上面。

与此同时，BandFuzz的性能下降了。罪魁祸首是我们的种子服务：在高压下，它崩溃了。BandFuzz退回到点对点同步，这意味着90%的时间浪费在模糊测试器之间洗牌种子上，而不是真正找到漏洞。

我们知道种子必须在处理同一目标的模糊测试器之间同步，但在这个规模上，点对点是不够的。所以我们构建了一个集中式种子最小化服务来阻止系统洪水。在第二轮之后，甚至那都不够——服务本身必须分布式。

所以我们用MapReduce风格的方法重新设计了整个事情：每个新种子的覆盖数据进入KV缓存，全局查询只获取不同的种子。

回顾过去，我为那部分感到自豪。模糊测试工作流是为规模而构建的：智能目标选择，高效种子同步，设计灵活。到5月底，我们锁定了它。模糊测试成为我们最终能标记为_"完成"_的第一个子系统。

但其他部分没有那么好。组织者宣布了一个新规则：提交重复补丁将被惩罚。为了处理它，我们想出了一个叫**"超级补丁"**的想法。

这个想法很聪明——对每个候选补丁运行每个PoV，测量"修复覆盖率"，并提交修复最多的补丁。修复漏洞超集的补丁成为_超级补丁_。简单，理论上优雅。

问题是时机。它需要一个全新的补丁组件，重新设计并连接到管道中，但我们距离第三轮只有一周，距离最终提交不到一个月。我被拉得很紧，试图保持整个系统在一起。其他人被埋在切片器中或淹没在开发工作中。所以这个滑过了。没有代码审查。没有PR。甚至没有我通常争论细节的习惯。

### 决赛前几周

决赛前几周是一片模糊。我们的程序切片器在第三轮中又崩溃了。系统让我日夜忙碌，而系里发送了关于我博士要求的礼貌但坚定的提醒。在保持系统运行和为资格考试死记硬背之间，没有太多喘息的空间。但不知怎么的，事情继续向前发展。

然后，经过两年不停的构建、修补、崩溃、修复和运行——我们终于站在了真正摊牌的起跑线上：决赛。

## DEF CON 33的决赛

决赛结果在2025年8月的拉斯维加斯DEF CON 33上宣布。那时，这是我第三次去维加斯。这座城市不再感觉新鲜。

出于某种原因，我不像去年那么兴奋了。活动本身感觉更小，更平淡。没有自助餐。没有Sphere。没有火车之旅。没有庆祝新补丁的卡通吉祥物。只有七台电视，每台都循环播放七个决赛团队的采访。我的脸在其中一台上。看着自己像那样感觉很奇怪，几乎是空洞的。

获胜者在第一天就宣布了。我们的团队坐在一起，在人群中看起来太小了。我们前面是Team Atlanta，占了整整五排。当组织者说他们的名字时，房间爆发了——感觉像地震。

我们是第六名。七个中的第六名。

## 哪里出了问题

AIxCC的计分方式是这样的：

<Callout title="计分" icon="💯">
- 每个正确的PoV提交（一个崩溃输入）得2分。
- 每个正确的补丁提交得6分。
- 每个正确的SARIF提交得1分。
- 如果你打包在一起（PoV + 补丁），你得到**1.5倍奖励倍数**。
</Callout>

现在，看看记分牌分解。（是的，他们标错了列——Bundle和SARIF分数颠倒了。）

![记分牌](images/aixcc/scoreboard.png)

仔细看，我们团队的表现是：
- PoV提交：70.37分——所有团队中_**第2**名_。
- SARIF提交：9.80分——_**第1**名_。
- 补丁提交：14.22分——_**第6**名_。

在纸面上，我们的补丁分数毫无意义。在我们的内部测试中，补丁成功率大约是缓解PoV的**90%**，修复根本原因的大约**50%**。我们不应该在补丁上接近底部。

但是然后来到仍然让人痛苦的部分。还记得我们匆忙推进的全新补丁组件——在决赛前一个月构建，没有代码审查？就是它。两个小漏洞，埋在里面，以恰好错误的方式相互作用。结果：我们管道中的每一个补丁代理在比赛的*第一天*就冻结了。它们只在最后才恢复生机——太晚了，无关紧要。实际上，**我们的系统运行了四天没有任何可用的补丁代理。** 那单一的失败拖累了我们的整个分数。

## 我们做错了什么

无论我们带着多少遗憾，它都不会改变事实：我们因为漏洞而失败了。每个系统都有裂缝。在这样的比赛中，你只有一次机会。

我不是团队领导。我没有权威指挥任何人。但是因为我设计了系统——并且实际上充当首席工程师——感觉我应该为我们犯的大部分技术错误负责。

我们的组件以自己的节奏发展，集成很混乱，实际上我们的"测试团队"只是一个人——一遍又一遍地重启管道以看漏洞是否修复。没有一天我们不重启系统。它从未运行超过48小时而不重置。

<Dialog>
那留下了一个巨大的漏洞：我们从未真正测试过系统如何随时间行为。
</Dialog>

是的，我们投入了努力。到最后，我们收集了近300个真实世界的有漏洞提交用作模拟测试。但人手太少，只有一小部分进入了套件。即使那样，我们很少深入挖掘结果。通常很难判断系统是否找到了预期的漏洞，或者只是偶然发现了一些不相关的漏洞。我们甚至没有审查生成的补丁，因为那需要人工分析。

我们如此狭隘地专注于一个指标——_它崩溃了还是没有？_——以至于我们忘记了更大的画面。一个伟大的系统不仅仅是活着的系统；它是一个理解自己能力的系统。未能强调这种理解是裂缝开始增长的地方。

最后的教训？最简单的一个：

**不要在最后一分钟触动你的代码。**

## 向其他团队致敬

尽管如此，失败并不意味着我们不欣赏其他人构建的东西。恰恰相反。

让我们诚实一点：我们永远无法击败Team Atlanta。他们太强了。所以这里是我对他们的真诚尊重和掌声——一个伟大的团队，伟大的人，做了伟大的工作。

我也对其他决赛选手的解决方案印象深刻。个人来说，我真的很欣赏Theori的系统。这是一个LLM优先的方法，代表了我希望这个领域继续朝着的确切方向。我真心享受阅读他们的代码。

Trail of Bits构建了一些感觉几乎像看我们自己系统的镜子——设计上有如此多的相似性，但有我们只能尊重的工程抛光水平。

我也感谢_all-you-need-is-a-fuzzing-brain_团队。我有机会在DEF CON与他们交谈，这真的是一种了解他们的乐趣。虽然他们是一个小团队，但他们表现得异常出色。

SHELLPHISH总是感觉像兄弟——BandFuzz的共同作者之一实际上在他们的团队里。我猜他们的系统像我们的一样遇到了障碍。我也相信他们远比记分牌显示的强。

最后，LACROSSE。我真的很惊讶看到他们用Lisp编写了整个系统——一种我甚至没有意识到仍然活着的语言。但他们做到了。为此：尊重。

## 在这段征程的最后

我的一个朋友说：_"啊，这该死的比赛终于结束了。"_

也许他们是对的。我可能谈论它太多了，太久了，直到连我的朋友都厌倦了听它。两年，数千次提交，无数次崩溃，还有比我能数的更多的不眠之夜。我们没有赢。但我带走了比奖品更大的东西：构建一个在规模上工作的系统的经验，有真正的能力，并且有一个我为成为其中一部分而自豪的团队。

我学会了如何与代码、与规模、与人——有时与我自己——搏斗。

两年一眨眼就过去了。但代码仍在运行。我们也是。